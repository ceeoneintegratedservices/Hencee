"use client";

import { useState } from "react";
import Image from "next/image";
import Link from "next/link";
import { useRouter } from "next/navigation";

interface SidebarProps {
  currentPage?: string;
  sidebarOpen?: boolean;
  setSidebarOpen?: (open: boolean) => void;
}

export default function Sidebar({ currentPage = "dashboard", sidebarOpen = true, setSidebarOpen }: SidebarProps) {
  const router = useRouter();

  // Handle logout
  const handleLogout = () => {
    localStorage.removeItem('authToken');
    localStorage.removeItem('userData');
    router.push('/login');
  };

  const menuItems = [
    {
      id: "dashboard",
      label: "Dashboard",
      href: "/dashboard",
      icon: (
        <svg className="w-4 h-4" fill="none" viewBox="0 0 20 20">
          <path d="M14.0755 0H17.4615C18.8637 0 20 1.14585 20 2.55996V5.97452C20 7.38864 18.8637 8.53449 17.4615 8.53449H14.0755C12.6732 8.53449 11.537 7.38864 11.537 5.97452V2.55996C11.537 1.14585 12.6732 0 14.0755 0" fill="currentColor" opacity="0.4"/>
          <path d="M5.9248 11.4658C7.3269 11.466 8.46285 12.6114 8.46289 14.0254V17.4404C8.46268 18.8533 7.3268 19.9998 5.9248 20H2.53809C1.13615 19.9998 0.000210316 18.8533 0 17.4404V14.0254C4.54606e-05 12.6115 1.13605 11.4661 2.53809 11.4658H5.9248ZM17.4619 11.4658C18.864 11.4661 20 12.6115 20 14.0254V17.4404C19.9998 18.8533 18.8639 19.9998 17.4619 20H14.0752C12.6732 19.9998 11.5373 18.8533 11.5371 17.4404V14.0254C11.5372 12.6114 12.6731 11.466 14.0752 11.4658H17.4619ZM5.9248 0C7.3268 0.000171152 8.46268 1.14575 8.46289 2.55957V5.97461C8.46285 7.38858 7.3269 8.53401 5.9248 8.53418H2.53809C1.13605 8.53394 4.52055e-05 7.38853 0 5.97461V2.55957C0.000210429 1.14579 1.13615 0.0002388 2.53809 0H5.9248Z" fill="currentColor"/>
        </svg>
      )
    },
    {
      id: "orders",
      label: "Orders",
      href: "/orders",
      icon: (
        <svg className="w-4 h-4" fill="none" viewBox="0 0 20 21">
          <path d="M14.2126 20.222H5.86477C2.79841 20.222 0.446004 19.1145 1.1142 14.6568L1.89223 8.6156C2.30413 6.39134 3.72289 5.54008 4.96774 5.54008H15.1462C16.4094 5.54008 17.7458 6.45542 18.2217 8.6156L18.9998 14.6568C19.5673 18.611 17.279 20.222 14.2126 20.222Z" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
          <path d="M14.3499 5.32041C14.3499 2.93433 12.4156 1.00004 10.0295 1.00004V1.00004C8.88053 0.99517 7.77692 1.4482 6.96273 2.25895C6.14854 3.06971 5.69085 4.17139 5.69086 5.32041H5.69086" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
        </svg>
      ),
      badge: "3"
    },
    {
      id: "inventory",
      label: "Inventory",
      href: "/inventory",
      icon: (
        <svg className="w-4 h-4" fill="none" viewBox="0 0 21 21">
          <path d="M20.169 14.482C20.169 18.06 18.06 20.169 14.482 20.169H6.7C3.113 20.169 1 18.06 1 14.482V6.682C1 3.109 2.314 1 5.893 1H7.893C8.611 1.001 9.287 1.338 9.717 1.913L10.63 3.127C11.062 3.701 11.738 4.039 12.456 4.04H15.286C18.873 4.04 20.197 5.866 20.197 9.517L20.169 14.482Z" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
          <path d="M6.2311 13.2129H14.9661" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
        </svg>
      )
    },
    {
      id: "customers",
      label: "Customers",
      href: "/customers",
      icon: (
        <svg className="w-4 h-4" fill="none" viewBox="0 0 21 20">
          <path d="M7.842 12.957C11.531 12.957 14.684 13.516 14.684 15.749C14.684 17.982 11.552 18.557 7.842 18.557C4.152 18.557 1 18.003 1 15.769C1 13.535 4.131 12.957 7.842 12.957Z" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
          <path d="M7.842 9.77C5.42 9.77 3.456 7.807 3.456 5.385C3.456 2.963 5.42 1 7.842 1C10.263 1 12.227 2.963 12.227 5.385C12.236 7.798 10.286 9.761 7.873 9.77H7.842Z" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
        </svg>
      )
    },
    {
      id: "approvals",
      label: "Approvals",
      href: "/approvals",
      icon: (
        <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24">
          <path d="M11.8248 1.3752C11.7121 1.26254 11.5593 1.19924 11.4 1.19924C11.2407 1.19924 11.0879 1.26254 10.9752 1.3752C10.8625 1.48786 10.7992 1.64067 10.7992 1.8C10.7992 1.95933 10.8625 2.11214 10.9752 2.2248L12.3516 3.6H11.4C9.61997 3.6 7.87991 4.12784 6.39987 5.11677C4.91983 6.10571 3.76627 7.51131 3.08508 9.15585C2.4039 10.8004 2.22567 12.61 2.57293 14.3558C2.9202 16.1016 3.77737 17.7053 5.03604 18.964C6.29471 20.2226 7.89836 21.0798 9.64419 21.4271C11.39 21.7743 13.1996 21.5961 14.8442 20.9149C16.4887 20.2337 17.8943 19.0802 18.8832 17.6001C19.8722 16.1201 20.4 14.38 20.4 12.6C20.4 12.4409 20.3368 12.2883 20.2243 12.1757C20.1117 12.0632 19.9591 12 19.8 12C19.6409 12 19.4883 12.0632 19.3757 12.1757C19.2632 12.2883 19.2 12.4409 19.2 12.6C19.2 14.1427 18.7425 15.6507 17.8855 16.9334C17.0284 18.2162 15.8102 19.2159 14.3849 19.8063C12.9597 20.3966 11.3913 20.5511 9.8783 20.2501C8.36524 19.9492 6.97542 19.2063 5.88457 18.1154C4.79372 17.0246 4.05084 15.6348 3.74987 14.1217C3.44891 12.6087 3.60338 11.0403 4.19374 9.61507C4.7841 8.18981 5.78385 6.97161 7.06655 6.11454C8.34926 5.25746 9.85731 4.8 11.4 4.8H12.3516L10.9752 6.1752C10.9194 6.23099 10.8752 6.29721 10.845 6.3701C10.8148 6.44299 10.7992 6.52111 10.7992 6.6C10.7992 6.67889 10.8148 6.75701 10.845 6.8299C10.8752 6.90279 10.9194 6.96901 10.9752 7.0248C11.0879 7.13746 11.2407 7.20076 11.4 7.20076C11.4789 7.20076 11.557 7.18522 11.6299 7.15503C11.7028 7.12484 11.769 7.08059 11.8248 7.0248L14.2248 4.6248C14.2807 4.56907 14.325 4.50285 14.3553 4.42996C14.3855 4.35707 14.4011 4.27892 14.4011 4.2C14.4011 4.12108 14.3855 4.04293 14.3553 3.97004C14.325 3.89715 14.2807 3.83093 14.2248 3.7752L11.8248 1.3752ZM16.0164 8.568C16.0731 8.62268 16.1185 8.688 16.15 8.76023C16.1815 8.83246 16.1985 8.91019 16.1999 8.98897C16.2014 9.06775 16.1873 9.14605 16.1585 9.21939C16.1297 9.29272 16.0867 9.35967 16.032 9.4164L11.412 14.2164C11.356 14.2745 11.2889 14.3207 11.2147 14.3522C11.1405 14.3838 11.0607 14.4 10.98 14.4C10.8993 14.4 10.8195 14.3838 10.7453 14.3522C10.6711 14.3207 10.604 14.2745 10.548 14.2164L8.568 12.1584C8.46448 12.0426 8.40989 11.8912 8.41572 11.736C8.42154 11.5808 8.48731 11.4339 8.59921 11.3262C8.71111 11.2185 8.86042 11.1584 9.01573 11.1585C9.17104 11.1586 9.32026 11.2189 9.432 11.3268L10.98 12.9348L15.168 8.5836C15.2227 8.52687 15.288 8.48146 15.3602 8.44997C15.4325 8.41849 15.5102 8.40154 15.589 8.40009C15.6678 8.39864 15.746 8.41272 15.8194 8.44153C15.8927 8.47034 15.9597 8.51332 16.0164 8.568Z" fill="currentColor"/>
        </svg>
      )
    },
    {
      id: "users_roles",
      label: "Users & Roles",
      href: "/users-roles",
      icon: (
        <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24">
          <path d="M12 12C14.7614 12 17 9.76142 17 7C17 4.23858 14.7614 2 12 2C9.23858 2 7 4.23858 7 7C7 9.76142 9.23858 12 12 12Z" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
          <path d="M20.59 22C20.59 18.13 16.74 15 12 15C7.26 15 3.41 18.13 3.41 22" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
        </svg>
      )
    },
    {
      id: "reports",
      label: "Reports",
      href: "/reports",
      icon: (
        <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24">
          <path d="M3 1.5H1.5V21C1.5 21.3978 1.65804 21.7794 1.93934 22.0607C2.22064 22.342 2.60218 22.5 3 22.5H22.5V21H3V1.5Z" fill="currentColor"/>
          <path d="M22.5 6.75H17.25V8.25H19.9425L14.25 13.9425L11.0325 10.7175C10.9628 10.6472 10.8798 10.5914 10.7884 10.5533C10.697 10.5153 10.599 10.4957 10.5 10.4957C10.401 10.4957 10.303 10.5153 10.2116 10.5533C10.1202 10.5914 10.0372 10.6472 9.9675 10.7175L4.5 16.1925L5.5575 17.25L10.5 12.3075L13.7175 15.5325C13.7872 15.6028 13.8702 15.6586 13.9616 15.6967C14.053 15.7347 14.151 15.7543 14.25 15.7543C14.349 15.7543 14.447 15.7347 14.5384 15.6967C14.6298 15.6586 14.7128 15.6028 14.7825 15.5325L21 9.3075V12H22.5V6.75Z" fill="currentColor"/>
        </svg>
      )
    },
    {
      id: "audits",
      label: "Audit Logs",
      href: "/audits",
      icon: (
        <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24">
          <path d="M12 13C11.6955 12.9964 11.3973 13.0862 11.1454 13.2573C10.8936 13.4284 10.7001 13.6725 10.5912 13.9568C10.4823 14.2411 10.4631 14.552 10.5361 14.8476C10.6092 15.1431 10.7711 15.4092 11 15.61V17C11 17.2652 11.1054 17.5196 11.2929 17.7071C11.4804 17.8946 11.7348 18 12 18C12.2652 18 12.5196 17.8946 12.7071 17.7071C12.8946 17.5196 13 17.2652 13 17V15.61C13.2289 15.4092 13.3908 15.1431 13.4639 14.8476C13.5369 14.552 13.5177 14.2411 13.4088 13.9568C13.2999 13.6725 13.1064 13.4284 12.8546 13.2573C12.6027 13.0862 12.3045 12.9964 12 13ZM17 9V7C17 5.67392 16.4732 4.40215 15.5355 3.46447C14.5979 2.52678 13.3261 2 12 2C10.6739 2 9.40215 2.52678 8.46447 3.46447C7.52678 4.40215 7 5.67392 7 7V9C6.20435 9 5.44129 9.31607 4.87868 9.87868C4.31607 10.4413 4 11.2044 4 12V19C4 19.7956 4.31607 20.5587 4.87868 21.1213C5.44129 21.6839 6.20435 22 7 22H17C17.7956 22 18.5587 21.6839 19.1213 20.5587C19.6839 19.7956 20 19.7956 20 19V12C20 11.2044 19.6839 10.4413 19.1213 9.87868C18.5587 9.31607 17.7956 9 17 9ZM9 7C9 6.20435 9.31607 5.44129 9.87868 4.87868C10.4413 4.31607 11.2044 4 12 4C12.7956 4 13.5587 4.31607 14.1213 4.87868C14.6839 5.44129 15 6.20435 15 7V9H9V7ZM18 19C18 19.2652 17.8946 19.5196 17.7071 19.7071C17.5196 19.8946 17.2652 20 17 20H7C6.73478 20 6.48043 19.8946 6.29289 19.7071C6.10536 19.5196 6 19.2652 6 19V12C6 11.7348 6.10536 11.4804 6.29289 11.2929C6.48043 11.1054 6.73478 11 7 11H17C17.2652 11 17.5196 11.1054 17.7071 11.2929C17.8946 11.4804 18 11.7348 18 12V19Z" fill="currentColor"/>
        </svg>
      )
    },
    {
      id: "expenses",
      label: "Expenses",
      href: "/expenses",
      icon: (
        <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1h-2m2 0h2" />
        </svg>
      )
    }
  ];

  return (
    <aside
      className={`fixed lg:static w-[296px] h-screen overflow-y-auto bg-white shadow-lg flex flex-col transition-transform duration-300 z-40
        ${sidebarOpen ? 'translate-x-0' : '-translate-x-full'}
        lg:translate-x-0 lg:block`}
    >
      {/* Top section with logo and navigation */}
      <div className="flex flex-col h-full">
        {/* Logo and Mobile Close Button */}
        <div className="flex items-center justify-between px-5 py-6 border-b border-gray-100 flex-shrink-0">
          <div className="flex items-center gap-3">
            <Image 
              src="/Ceeone Asset/Ceeonewheels _logo_2.png" 
              alt="Ceeone Wheels Logo" 
              width={60} 
              height={60} 
              className="w-15 h-15 object-contain" 
            />
            <span className="font-bold text-[20px] text-black font-['Work_Sans']">Ceeone Wheels</span>
          </div>
          {/* Mobile Close Button */}
          {setSidebarOpen && (
            <button 
              className="lg:hidden p-2 rounded-md hover:bg-gray-100 transition-colors"
              onClick={() => setSidebarOpen(false)}
            >
              <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          )}
        </div>
        
        {/* Menu - Scrollable area */}
        <nav className="flex flex-col gap-4 mt-6 px-6 flex-1 overflow-y-auto">
          {menuItems.map((item) => (
            <Link
              key={item.id}
              href={item.href}
              className={`flex items-center gap-3 px-4 py-3 rounded-xl font-medium relative hover:bg-[#02016a] hover:text-white transition-colors ${
                currentPage === item.id 
                  ? 'bg-[#02016a] text-white' 
                  : 'text-[#101828]'
              }`}
            >
              <span className="w-5 h-5 flex items-center justify-center">
                {item.icon}
              </span>
              <span className="text-sm">{item.label}</span>
              {item.badge && (
                <span className="ml-auto bg-[#ffcc91] text-[#1c1d22] rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold">
                  {item.badge}
                </span>
              )}
            </Link>
          ))}
          
          {/* Settings and Logout moved up */}
          <div className="mt-8 pt-4 border-t border-gray-100">
            <Link className="flex items-center gap-3 px-4 py-3 rounded-xl text-[#101828] font-medium hover:bg-[#02016a] hover:text-white transition-colors" href="/settings">
              <span className="w-5 h-5 flex items-center justify-center">
                <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24">
                  <path d="M10.825 22C10.375 22 9.98767 21.85 9.663 21.55C9.33833 21.25 9.14233 20.8833 9.075 20.45L8.85 18.8C8.63333 18.7167 8.42933 18.6167 8.238 18.5C8.04667 18.3833 7.859 18.2583 7.675 18.125L6.125 18.775C5.70833 18.9583 5.29167 18.975 4.875 18.825C4.45833 18.675 4.13333 18.4083 3.9 18.025L2.725 15.975C2.49167 15.5917 2.425 15.1833 2.525 14.75C2.625 14.3167 2.85 13.9583 3.2 13.675L4.525 12.675C4.50833 12.5583 4.5 12.4457 4.5 12.337V11.662C4.5 11.554 4.50833 11.4417 4.525 11.325L3.2 10.325C2.85 10.0417 2.625 9.68333 2.525 9.25C2.425 8.81667 2.49167 8.40833 2.725 8.025L3.9 5.975C4.13333 5.59167 4.45833 5.325 4.875 5.175C5.29167 5.025 5.70833 5.04167 6.125 5.225L7.675 5.875C7.85833 5.74167 8.05 5.61667 8.25 5.5C8.45 5.38333 8.65 5.28333 8.85 5.2L9.075 3.55C9.14167 3.11667 9.33767 2.75 9.663 2.45C9.98833 2.15 10.3757 2 10.825 2H13.175C13.625 2 14.0127 2.15 14.338 2.45C14.6633 2.75 14.859 3.11667 14.925 3.55L15.15 5.2C15.3667 5.28333 15.571 5.38333 15.763 5.5C15.955 5.61667 16.1423 5.74167 16.325 5.875L17.875 5.225C18.2917 5.04167 18.7083 5.025 19.125 5.175C19.5417 5.325 19.8667 5.59167 20.1 5.975L21.275 8.025C21.5083 8.40833 21.575 8.81667 21.475 9.25C21.375 9.68333 21.15 10.0417 20.8 10.325L19.475 11.325C19.4917 11.4417 19.5 11.5543 19.5 11.663V12.337C19.5 12.4457 19.4833 12.5583 19.45 12.675L20.775 13.675C21.125 13.9583 21.35 14.3167 21.45 14.75C21.55 15.1833 21.4833 15.5917 21.25 15.975L20.05 18.025C19.8167 18.4083 19.4917 18.675 19.075 18.825C18.6583 18.975 18.2417 18.9583 17.825 18.775L16.325 18.125C16.1417 18.2583 15.95 18.3833 15.75 18.5C15.55 18.6167 15.35 18.7167 15.15 18.8L14.925 20.45C14.8583 20.8833 14.6627 21.25 14.338 21.55C14.0133 21.85 13.6257 22 13.175 22H10.825ZM11 20H12.975L13.325 17.35C13.8417 17.2167 14.321 17.021 14.763 16.763C15.205 16.505 15.609 16.1923 15.975 15.825L18.45 16.85L19.425 15.15L17.275 13.525C17.3583 13.2917 17.4167 13.046 17.45 12.788C17.4833 12.53 17.5 12.2673 17.5 12C17.5 11.7327 17.4833 11.4703 17.45 11.213C17.4167 10.9557 17.3583 10.7097 17.275 10.475L19.425 8.85L18.45 7.15L15.975 8.2C15.6083 7.81667 15.2043 7.496 14.763 7.238C14.3217 6.98 13.8423 6.784 13.325 6.65L13 4H11.025L10.675 6.65C10.1583 6.78333 9.67933 6.97933 9.238 7.238C8.79667 7.49667 8.39233 7.809 8.025 8.175L5.55 7.15L4.575 8.85L6.725 10.45C6.64167 10.7 6.58333 10.95 6.55 11.2C6.51667 11.45 6.5 11.7167 6.5 12C6.5 12.2667 6.51667 12.525 6.55 12.775C6.58333 13.025 6.64167 13.275 6.725 13.525L4.575 15.15L5.55 16.85L8.025 15.8C8.39167 16.1833 8.796 16.5043 9.238 16.763C9.68 17.0217 10.159 17.2173 10.675 17.35L11 20ZM12.05 15.5C13.0167 15.5 13.8417 15.1583 14.525 14.475C15.2083 13.7917 15.55 12.9667 15.55 12C15.55 11.0333 15.2083 10.2083 14.525 9.525C13.8417 8.84167 13.0167 8.5 12.05 8.5C11.0667 8.5 10.2377 8.84167 9.563 9.525C8.88833 10.2083 8.55067 11.0333 8.55 12C8.54933 12.9667 8.887 13.7917 9.563 14.475C10.239 15.1583 11.068 15.5 12.05 15.5Z" fill="currentColor"/>
                </svg>
              </span>
              <span className="text-sm">Settings</span>
            </Link>
            <button 
              onClick={handleLogout}
              className="flex items-center gap-3 px-4 py-3 rounded-xl text-[#ee174b] font-medium w-full text-left hover:bg-red-50 transition-colors mt-2"
            >
              <span className="w-5 h-5 flex items-center justify-center">
                <svg className="w-4 h-4" fill="none" viewBox="0 0 20 20">
                  <path d="M0 4.447C0 1.996 2.03024 0 4.52453 0H9.48564C11.9748 0 14 1.99 14 4.437V15.553C14 18.005 11.9698 20 9.47445 20H4.51537C2.02515 20 0 18.01 0 15.563V14.623V4.447Z" fill="#EE174B" opacity="0.4"/>
                  <path d="M19.7789 9.4548L16.9331 6.5458C16.639 6.2458 16.1657 6.2458 15.8725 6.5478C15.5804 6.8498 15.5813 7.3368 15.8745 7.6368L17.4337 9.2298H15.9388H7.54845C7.13454 9.2298 6.79854 9.5748 6.79854 9.9998C6.79854 10.4258 7.13454 10.7698 7.54845 10.7698H17.4337L15.8745 12.3628C15.5813 12.6628 15.5804 13.1498 15.8725 13.4518C16.0196 13.6028 16.2115 13.6788 16.4043 13.6788C16.5952 13.6788 16.787 13.6028 16.9331 13.4538L19.7789 10.5458C19.9201 10.4008 20 10.2048 20 9.9998C20 9.7958 19.9201 9.5998 19.7789 9.4548" fill="#EE174B"/>
                </svg>
              </span>
              <span className="text-sm">Logout</span>
            </button>
          </div>
        </nav>
      </div>
    </aside>
  );
}
